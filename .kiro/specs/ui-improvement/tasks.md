# Implementation Plan

## Tasks

- [ ] 1. ASCIIアートパッケージの実装
- [x] 1.1 (P) ゲームロゴのASCIIアート描画機能を実装
  - TypeBattleロゴを5-8行のフィグレット風ASCIIアートで表現
  - カラーモード・モノクロモードの両方に対応
  - ロゴの幅と高さを取得できるインターフェースを提供
  - 中央揃え表示をサポート
  - _Requirements: 1.1_

- [x] 1.2 (P) 大きな数字のASCIIアート描画機能を実装
  - 0-9の数字を3-5行のASCIIアートで表現
  - 複数桁の数値を連結して表示
  - カラー対応（レベルに応じた色分け）
  - 負数は0、1000以上は999+として表示
  - _Requirements: 1.4_

- [x] 1.3 (P) 戦闘結果（WIN/LOSE）のASCIIアート描画機能を実装
  - 勝利時は緑色でWINを大きく表示
  - 敗北時は赤色でLOSEを大きく表示
  - エージェントエリア内に収まるサイズで設計
  - _Requirements: 3.9_

- [ ] 2. アニメーションシステムの実装
- [x] 2.1 (P) HPバーのスムーズアニメーション機能を実装
  - 目標HPへの滑らかな補間（線形またはイージング）
  - 100msごとの更新で自然なアニメーションを実現
  - 増加（回復）と減少（ダメージ）で異なる速度設定
  - アニメーション中かどうかの状態管理
  - 表示HPは0からMaxHPの範囲に制限
  - _Requirements: 3.3_

- [x] 2.2 (P) フローティングダメージ/回復表示機能を実装
  - ダメージ/回復発生時に数値を一時表示（2-3秒）
  - Y方向への浮遊アニメーション
  - 複数の同時表示をサポート
  - ダメージは赤、回復は緑で表示
  - 対象エリア（敵、プレイヤー、エージェント）を指定可能
  - _Requirements: 3.4_

- [ ] 3. 再利用可能UIコンポーネントの実装
- [x] 3.1 (P) エージェント情報カードコンポーネントを実装
  - エージェント名、レベル、コアタイプ、HP（オプション）を表示
  - 選択状態・非選択状態のスタイル切り替え
  - コンパクト（横並び用）と詳細（単体表示用）の2種類のレイアウト
  - エージェントがnilの場合は空スロット表示
  - 幅が狭い場合のテキスト切り詰め処理
  - _Requirements: 1.5, 2.7, 3.2_

- [x] 3.2 (P) 確認ダイアログコンポーネントを実装
  - モーダルダイアログとして画面中央に表示
  - タイトル、メッセージ、はい/いいえボタンを表示
  - 左右キーで選択、Enterで決定、Escでキャンセル
  - 表示/非表示の状態管理
  - _Requirements: 2.9_

- [x] 3.3 (P) モジュールカテゴリアイコン機能を実装
  - 各ModuleCategoryに対応するUnicode/ASCIIアイコンを返す
  - 物理攻撃: 剣、魔法攻撃: 星、回復: ハート、バフ: 上矢印、デバフ: 下矢印
  - カラー付きアイコン取得機能
  - _Requirements: 3.6_

- [ ] 4. ホーム画面のUI改善
- [x] 4.1 ホーム画面にASCIIアートロゴとレベル表示を統合
  - 画面上部にTypeBattleロゴをASCIIアートで表示
  - ASCIILogoコンポーネントを使用
  - サブタイトル（Terminal Typing Battle Game）を表示
  - _Requirements: 1.1_

- [x] 4.2 ホーム画面を左右分割レイアウトに変更
  - 左側にメインメニュー、右側に進行状況パネルを横並び配置
  - メインメニューの下部に操作キーヘルプを表示
  - lipgloss.JoinHorizontalでレイアウト構成
  - _Requirements: 1.2, 1.3_

- [x] 4.3 進行状況パネルに到達レベルと装備エージェント一覧を表示
  - 到達最高レベルをASCII数字アートで表示
  - ASCIINumbersコンポーネントを使用
  - 装備中エージェント一覧をAgentCardで表示
  - _Requirements: 1.4, 1.5_

- [x] 4.4 装備なし時の誘導メッセージとバトル無効化を実装
  - 装備エージェントが空の場合、エージェント管理への誘導メッセージを表示
  - バトル選択メニューをグレーアウトして無効化
  - 無効なメニューを選択した場合、理由を表示
  - _Requirements: 1.6, 5.3_

- [ ] 5. エージェント管理画面のUI改善
- [x] 5.1 合成タブの左右分割レイアウトを実装
  - 左側に選択可能なパーツ（コア/モジュール）のリストを表示
  - 右側に合成用に選択済みのパーツ一覧を表示
  - lipgloss.JoinHorizontalでレイアウト構成
  - _Requirements: 2.1, 2.2_

- [x] 5.2 合成タブにパーツ詳細と完成予測ステータスを表示
  - 左側リスト下部にカーソル中のパーツの詳細性能を表示
  - 右側選択済み一覧の下部に完成後のエージェントステータス予測を表示
  - ステータス計算ロジックを実装
  - _Requirements: 2.3, 2.4_

- [x] 5.3 装備タブの上下分割レイアウトを実装
  - 上部エリア左側に所持エージェント一覧を縦リストで表示
  - 上部エリア右側に選択中エージェントの詳細を表示
  - 下部エリアに装備中の3体のエージェントを横並びのカードで表示
  - AgentCardコンポーネントを使用
  - _Requirements: 2.5, 2.6, 2.7_

- [x] 5.4 装備タブのスロット切替と削除確認を実装
  - Tabキーによる選択スロット（1〜3）の切り替え
  - エージェント削除時にConfirmDialogを表示
  - 削除確認後のエージェント削除処理
  - _Requirements: 2.8, 2.9_

- [ ] 6. バトル画面のUI改善
- [x] 6.1 バトル画面を3エリアレイアウトに再構成
  - 上から敵情報エリア、エージェントエリア、プレイヤー情報エリアを配置
  - 各エリアをボーダー付きパネルで区切り
  - lipgloss.JoinVerticalでレイアウト構成
  - _Requirements: 3.1_

- [x] 6.2 エージェントエリアに装備エージェントカードを横並び表示
  - 装備中の3体のエージェントをAgentCardで表示
  - 選択中のエージェントをハイライト
  - 各エージェントのモジュール一覧とクールダウン状態を表示
  - _Requirements: 3.2_

- [x] 6.3 HPバーにアニメーションとフローティングダメージを統合
  - AnimatedHPBarを敵HP、プレイヤーHPに適用
  - ダメージ/回復発生時にFloatingDamageManagerでエフェクト表示
  - 100msごとのtickでアニメーション更新
  - _Requirements: 3.3, 3.4_

- [x] 6.4 敵攻撃タイマーとバフ・デバフ表示を実装
  - 次の敵攻撃までの時間をプログレスバーで視覚化
  - バフは青系、デバフは赤系で視覚的に区別
  - 残り時間を秒単位で表示
  - _Requirements: 3.5, 3.7_

- [x] 6.5 タイピングチャレンジの色分け表示を実装
  - 入力済み文字を完了色で表示
  - 現在位置をカーソル色でハイライト
  - 未入力文字を未完了色で表示
  - 進捗（入力済み/全体）を表示
  - _Requirements: 3.8_

- [x] 6.6 戦闘終了時のWIN/LOSEアスキーアート表示を実装
  - 勝利時はエージェントエリアにWINアートを表示
  - 敗北時はエージェントエリアにLOSEアートを表示
  - WinLoseASCIIコンポーネントを使用
  - _Requirements: 3.9_

- [ ] 7. カラーテーマとスタイルの統一
- [x] 7.1 (P) 全画面でカラーパレットとボーダースタイルを統一
  - styles.goで定義済みのカラーパレットを全画面で使用
  - RoundedBorderを全画面で統一使用
  - プライマリ・セカンダリ・アクセントカラーの使い分けを明確化
  - _Requirements: 4.1, 4.2, 4.3_

- [x] 7.2 (P) テキスト階層スタイルを全画面に適用
  - タイトル、サブタイトル、本文、補足の4階層スタイルを定義
  - 各画面でテキスト階層を一貫して使用
  - フォントサイズ（行数）、太さ、色で階層を表現
  - _Requirements: 4.5_

- [x] 7.3 モノクロ代替表示機能を実装
  - カラー非対応ターミナル検出機能を実装
  - モノクロモード用のGameStyles初期化関数を追加
  - 全コンポーネントでモノクロモード対応を確認
  - _Requirements: 4.4_

- [ ] 8. 視覚的フィードバックの強化
- [x] 8.1 選択項目ハイライトとフォーカスアニメーションを実装
  - メニュー項目選択時のハイライト表示
  - カーソル位置の明示（記号、色変化）
  - フォーカス受け取り時のアニメーション効果
  - _Requirements: 5.1, 5.2_

- [x] 8.2 エラーメッセージと成功フィードバックを実装
  - 無効操作時のエラーメッセージ表示（赤色、2秒で消去）
  - 操作成功時の成功フィードバック表示（緑色、1秒で消去）
  - エラーメッセージには無効な操作の理由を含める
  - 画面下部にメッセージエリアを配置
  - _Requirements: 5.3, 5.4_

- [ ] 9. 統合テストとシステム検証
- [ ] 9.1 ホーム画面の表示と操作フローをテスト
  - ASCIIロゴ、レベル表示、メニュー、進行状況の正しい配置を検証
  - 装備なし時の誘導メッセージとバトル無効化を検証
  - メニューナビゲーションの動作確認
  - _Requirements: 1.1, 1.2, 1.3, 1.4, 1.5, 1.6_

- [ ] 9.2 エージェント管理画面の操作フローをテスト
  - 合成タブの左右分割レイアウトとパーツ選択を検証
  - 装備タブのエージェント選択とスロット切り替えを検証
  - 削除確認ダイアログの表示と結果反映を検証
  - _Requirements: 2.1, 2.2, 2.3, 2.4, 2.5, 2.6, 2.7, 2.8, 2.9_

- [ ] 9.3 バトル画面のアニメーションと表示をテスト
  - 3エリアレイアウトの正しい配置を検証
  - HPアニメーションとフローティングダメージの動作を検証
  - タイピングチャレンジの色分けとWIN/LOSE表示を検証
  - _Requirements: 3.1, 3.2, 3.3, 3.4, 3.5, 3.6, 3.7, 3.8, 3.9_

- [ ] 9.4 カラーテーマと視覚フィードバックをテスト
  - 全画面でのカラーパレット統一を検証
  - モノクロモード切り替えの動作を検証
  - エラーメッセージと成功フィードバックの表示を検証
  - _Requirements: 4.1, 4.2, 4.3, 4.4, 4.5, 5.1, 5.2, 5.3, 5.4_
