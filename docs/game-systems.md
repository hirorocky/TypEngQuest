# 主要ゲームシステム

## ワールドシステム ⭐ 新機能
このゲームはワールド単位で進行し、各ワールドにはボスが存在します。

### ワールドの構造
- **階層構造**: 各ワールドは最大深度を持つファイルシステム風マップ
- **ボス配置**: 最深部（最大深度）にボスディレクトリが存在
- **鍵システム**: ボスディレクトリへのアクセスには鍵が必要
- **クリア条件**: ボスを倒すとワールドクリア

### ワールド進行システム
- **ワールドクリア後の選択**:
  - レベルアップ（難易度上昇）
  - レベル維持（同難易度継続）
  - レベルダウン（難易度軽減）
- **ワールドリタイア**: いつでも現ワールドを破棄して新ワールド生成可能
- **データ引き継ぎ**: プレイヤーステータス・装備は全て維持
- **履歴保存**: クリアしたワールドの思い出情報のみ保存

### 鍵システム
- **鍵の入手**: 宝箱から取得
- **所持制限**: 1つまでのみ保持可能
- **用途**: ボスディレクトリへのアクセス
- **ワールドリセット**: 新ワールド移行時に鍵は失う

### ボスディレクトリ
- **特別な見た目**: 他のディレクトリと区別可能な表示
- **アクセス制御**: 鍵なしアクセス時はUnix風エラーメッセージ
- **配置場所**: 各ワールドの最深部に確実に配置

## マップ・探索システム
- **ファイルシステム構造**: プロジェクトディレクトリ風の階層構造マップ
- **自動生成**: ランダムなディレクトリ・ファイル構造を生成
- **ナビゲーション**: `cd`, `ls`, `pwd`, `tree` コマンドで移動・探索
- **位置情報**: 現在位置をパス形式で表示 (`/projects/web-app/src/components/`)

### マップ要素
- **モンスター** 🐛: ファイル内に潜む敵（`.js`, `.ts`, `.py` 等のファイル）
- **宝箱** 📦: ランダム装備を含む (`package.json`, `config.json` 等)
- **ランダムイベント** 🎲: 良い事・悪い事がランダム発生 (`CHANGELOG.md`, `TODO.md`, `.env`, `.git/` 等)
- **セーブポイント** 💾: HP/MP全回復 (`README.md`, `docs/` 等)

### 場所タイプ分類
- **ディレクトリ**: 基本的に安全、内部にランダム要素配置
- **実行ファイル** (`.exe`, `.bin`): 高確率でモンスター
- **設定ファイル** (`.json`, `.yaml`): 宝箱やランダムイベント
- **ドキュメント** (`.md`, `.txt`): セーブポイントやランダムイベント
- **隠しファイル** (`.`で始まる): ランダムイベント（悪い事の確率高）
- **システムファイル** (`.git/`, `.env`): ランダムイベント（悪い事メイン）

## エンカウント・相互作用システム
- **ファイル検査**: `cat`, `head`, `file` コマンドで内容を調査
- **相互作用判定**: ファイルタイプに応じた要素が判明
- **確率システム**: 
  - モンスター: 20-80% (ファイルタイプ依存)
  - 宝箱: 10-30% (設定ファイルで高確率)
  - ランダムイベント: 10-40% (ファイルタイプ依存)
  - セーブポイント: 15-25% (ドキュメントで高確率)

### 探索詳細システム
- **段階的発見**: `ls` → `file` → `cat` の順で詳細が判明
- **危険度表示**: ファイル拡張子や名前から危険度を推測可能
- **探索報酬**: 新エリア発見、隠しファイル発見で経験値獲得
- **記憶システム**: 一度調査したファイルの内容は記憶される

## 装備ドロップシステム
- **敵撃破報酬**: 敵を倒すと確率で英単語装備がドロップ
- **宝箱システム**: 宝箱から確実に装備獲得、レアリティが高い
- **レアリティシステム**: Common, Uncommon, Rare, Epic, Legendary の5段階
- **場所ボーナス**: ファイルタイプに応じた専用装備
  - `.js/.ts`: JavaScript/TypeScript関連単語
  - `.py`: Python関連単語  
  - `.md`: ドキュメント関連単語
  - `package.json`: 依存関係関連単語
- **装備発見**: 新しい単語を発見してコレクションに追加

## 装備システム
- 単語は個別のステータスを持つ: `{ attack: number, defense: number, speed: number, accuracy: number, critical: number }`
- 装備効果は装備中の全単語ステータスの合計
- 装備中の単語は有効な英文を構成する必要がある
- 文法検証がダメージ出力に影響
- **レアリティによるステータス倍率**: 高レアリティほど強力なステータス

## 戦闘システム
- プログラミング概念に基づくタイピングチャレンジ
- 難易度レベル: 1単語 (基本) → 1文章 (上級)
- ダメージ = 基本ATK × 速度ボーナス × 精度ボーナス × 文法ボーナス
- タイピング完璧性に基づくクリティカルヒット
- **戦闘勝利**: 敵撃破時にドロップ判定とアイテム獲得
- **場所効果**: ファイルタイプに応じた戦闘ボーナス

## ランダムイベントシステム
発生時に良い事・悪い事がランダムで決定される統合システム

### **良いイベント（40-60%の確率）**
- **装備発見**: レア装備の発見
- **経験値ボーナス**: 追加経験値獲得
- **ステータスアップ**: 一時的なステータス強化
- **情報入手**: マップのヒントや隠し場所の情報
- **ショートカット発見**: 便利な移動手段の発見

### **悪いイベント（40-60%の確率）**
- **ダメージ**: HP減少（タイピングで軽減可能）
- **デバフ**: ステータス低下（タイピングで解除可能）
- **迷子**: ランダム移動（タイピングで阻止可能）
- **装備破損**: 装備の一時無効化（タイピングで修復可能）
- **ウイルス感染**: 継続ダメージ（タイピングで除去可能）

### **タイピング回避システム**
悪いイベント発生時に緊急タイピングチャレンジが開始
- **制限時間**: 10-30秒（イベントの深刻度による）
- **成功条件**: 指定されたプログラミング用語を正確にタイピング
- **完全成功**: 悪影響を完全回避
- **部分成功**: 悪影響を軽減（50-80%カット）
- **失敗**: 悪影響をフルに受ける

## ゲーム内コマンド
```bash
# 基本ゲームコマンド
help          # 利用可能な全コマンドを表示
status        # プレイヤーステータスと装備ボーナスを表示
inventory     # インベントリ内の利用可能な単語を表示
equipment     # 装備中の単語と現在の文章を表示
equip 1 the   # スロット1に単語"the"を装備
unequip 1     # スロット1から単語を削除
validate      # 現在の文章の文法をチェック
start         # アドベンチャー開始
quit          # ゲーム終了

# ナビゲーションコマンド ✅ 実装済み
pwd           # 現在位置表示
ls            # 現在ディレクトリの内容表示
ls -a         # 隠しファイルも表示
ls -l         # 詳細情報表示
ls -la        # 隠しファイル + 詳細情報表示
cd <path>     # 指定パスに移動
cd ..         # 親ディレクトリに移動
cd ~          # ルートディレクトリに移動
cd            # ルートディレクトリに移動（引数なし）
```

### 実装予定のコマンド
```bash
# 拡張ナビゲーション
tree          # ディレクトリツリー表示
find <name>   # ファイル・ディレクトリ検索

# ファイル調査・相互作用 🚧 次期実装
file <name>   # ファイルタイプ調査（要素のヒント表示）
cat <name>    # ファイル内容表示（イベント・情報確認）
head <name>   # ファイルの先頭部分表示
interact <name> # ファイルと相互作用（戦闘・宝箱・トラップ等実行）

# ワールド・ボスシステム 🔴 Redテスト完了
world         # 現在ワールド情報表示
boss          # ボス情報表示
retire        # ワールドリタイア（新ワールド生成）
history       # ワールドクリア履歴表示

# 探索・戦闘・イベント
explore       # 現在地を詳細探索（隠し要素発見）
battle        # 敵との戦闘開始（ドロップ獲得チャンス）
save          # セーブポイントで回復・データ保存
events        # ランダムイベント一覧・進行状況確認
map           # 現在位置周辺のマップ表示

# コレクション・管理
collection    # 収集した装備の図鑑表示
drops         # 最近のドロップ履歴表示
rarity        # レアリティ別装備一覧
search        # 特定の装備を検索
locations     # 訪問済み場所の一覧
randomevents  # 発生済みランダムイベントの履歴
```

### コマンド例
```bash
> start              # ゲーム開始
> pwd                # 現在位置表示
> ls                 # 現在ディレクトリの内容表示
> ls -la             # 隠しファイルも含めて表示
> cd src             # srcディレクトリに移動
> cd ..              # 親ディレクトリに移動
> tree               # ディレクトリツリー表示
> file app.py        # ファイルタイプを調査（要素のヒント）
> cat README.md      # ファイル内容を確認（セーブポイントやイベント）
> head package.json  # ファイルの先頭を確認
> interact app.py    # ファイルと相互作用（戦闘・宝箱・トラップ等）
> save               # セーブポイントでゲーム保存
> battle             # 敵との戦闘開始
> equip 1 the        # スロットに単語を装備
> validate           # 文法チェック
> status             # ステータス表示
> inventory          # 所持単語一覧表示
> collection         # 装備コレクション表示
> drops              # 最近のドロップ履歴表示
> map                # 現在位置周辺のマップ表示
> events             # 発生中/完了済みランダムイベント一覧
```